function import$(r,t){var e={}.hasOwnProperty;for(var n in t)e.call(t,n)&&(r[n]=t[n]);return r}var x$;x$=angular.module("main",[]),x$.controller("detail",["$scope"].concat(function(r){return r.loading=!0,r.clsmap={"政策基礎":"context","資料集":"dataset","影響力":"impact"},d3.csv("detail.csv",function(t){var e,n,o,a,u,c,i,s,l,d,f;t=d3.nest().key(function(r){return r["資料集類別"]}).rollup(function(r){var t,e,n,o,a,u,c,i,s,l;for(t=function(){var t=[];for(e in r[0])t.push(e);return t}().filter(function(r){return/^\d+\./.exec(r)}),n={},o=0,a=t.length;a>o;++o)for(u=t[o],c=u.replace(/^\d+\.\s*/,""),n[c]=0,i=0,s=r.length;s>i;++i)l=r[i],n[c]=n[c]+ +l[u];for(o=0,a=t.length;a>o;++o)u=t[o],c=u.replace(/^\d+\.\s*/,""),n[c]=Math.round(100*n[c]/r.length);return n}).entries(t),n=[];for(o in t[0].values)n.push(o);for(e=n,n=[],u=0,c=e.length;c>u;++u){for(i=e[u],s={name:i},l=0,d=t.length;d>l;++l)f=t[l],s[f.key]={value:f.values[i],rank:Math.floor(f.values[i]/33.33)};n.push(s)}return a=n,r.$apply(function(){return r.table=a,r.detail=t}),d3.csv("score.csv",function(t){function e(){var r,t=[];for(i in r=c)s=r[i],t.push(s);return t}function n(r,t){return r+t.sum}var o,a,u,c,i,s,l,d,f,m,h,g,p,v,x,S;setTimeout(function(){return document.querySelector("#root").setAttribute("class","ld ld-over-full-inverse")},1e3),o={danger:"#ff5135",success:"#00f2c1",primary:"#00b4ed",warning:"#ffdc6c",info:"#e285ff"},a=d3.nest().key(function(r){return r.Category}).key(function(r){return r["Sub-category"]}).rollup(function(r){var t;return t=r.reduce(function(r,t){return r+ +t["Weighted Score"]},0),{values:r,sum:t}}).map(t);for(u in a){c=a[u],c.sum=e().reduce(n,0);for(i in c)s=c[i],s.subscore=100*s.sum/(c.sum||1)}for(l=d3.nest().key(function(r){return r.Category}).map(t),d=d3.nest().key(function(r){return r["Sub-category"]}).rollup(function(r){var t;return t=r.reduce(function(r,t){return r+ +t["Weighted Score"]},0),{values:r,sum:t}}).entries(t),f=0,m=d.length;m>f;++f)h=d[f],h["總計"]=Math.round(100*h.values.sum)/100;return r.$apply(function(){return r.subcats=d}),g={radar:plotdb.chart.get("Radar Chart"),column:plotdb.chart.get("Column Chart")},p={gridShow:!1,xAxisShow:!0,yAxisShow:!1,xAxisStroke:"#f92",fill:"#f92",labelShow:!1},v={gridStroke:"#ddd",gridBackground:"none",gridDashArray:"1 0",gridStrokeWidth:.5,palette:{colors:[{hex:o.danger}]},nodeFill:o.danger,stroke:o.danger,nodeSize:10,legendShow:!1,aAxisShow:!0,rAxisShow:!1},g.context=g.column.clone(),g.dataset=g.column.clone(),g.impact=g.column.clone(),g.radar.data(d,!1,{radius:["總計"],order:["key"]}),g.impact.data(l["影響力"],!1,{value:["Raw Score"],order:["Item"]}),g.context.data(l["政策基礎"],!1,{value:["Raw Score"],order:["Item"]}),g.dataset.data(l["資料集"],!1,{value:["Raw Score"],order:["Item"]}),g.radar.config(v),g.context.config((x=import$({},p),x.fill=o.success,x.xAxisStroke=o.success,x)),g.dataset.config((x=import$({},p),x.fill=o.warning,x.xAxisStroke=o.warning,x)),g.impact.config((x=import$({},p),x.fill=o.info,x.xAxisStroke=o.info,x)),g.radar.attach("#chart-attr"),g.context.attach("#chart-context"),g.dataset.attach("#chart-dataset"),g.impact.attach("#chart-impact"),S=function(r,t){return document.querySelector(r).innerText=Math.round(t)},S("#sum-context .score",a["政策基礎"].sum),S("#sum-dataset .score",a["資料集"].sum),S("#sum-impact .score",a["影響力"].sum),console.log(d),r.$apply(function(){return r.loading=!1})})})}));